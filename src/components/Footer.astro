---
import { Rss, FileText, Heart, ExternalLink } from "lucide-astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import {
  getCategoriesWithPosts,
  getCategoryDisplayName,
  getCategoryUrl,
} from "../utils/categories";

const today = new Date();

// Get categories that have posts
const categoriesWithPosts = await getCategoriesWithPosts();
---

<footer
  class="bg-background-secondary border-t border-border-light text-text py-12 mt-12 shadow-sm"
>
  <div class="px-xl flex flex-col gap-12">
    <!-- Main footer section -->
    <div class="grid grid-cols-1 lg:grid-cols-[1fr_2fr] gap-12 lg:items-start">
      <div class="flex flex-col gap-lg">
        <h3
          class="font-heading text-2xl font-bold text-heading m-0 leading-tight tracking-tight"
        >
          {SITE_TITLE}
        </h3>
        <p
          class="text-base leading-relaxed text-text-light m-0 max-w-[40ch] text-justify"
        >
          {SITE_DESCRIPTION}
        </p>
      </div>

      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        <div class="flex flex-col gap-md">
          <h4
            class="font-heading text-lg font-semibold text-heading m-0 leading-tight tracking-tight"
          >
            Navigation
          </h4>
          <ul class="list-none p-0 m-0 flex flex-col gap-sm">
            <li class="list-none m-0">
              <a
                href="/"
                class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
                >Home</a
              >
            </li>
            <li class="list-none m-0">
              <a
                href="/writings"
                class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
                >Writings</a
              >
            </li>
            <li class="list-none m-0">
              <a
                href="/about"
                class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
                >About</a
              >
            </li>
          </ul>
        </div>

        <div class="flex flex-col gap-md">
          <h4
            class="font-heading text-lg font-semibold text-heading m-0 leading-tight tracking-tight"
          >
            Categories
          </h4>
          <ul class="list-none p-0 m-0 flex flex-col gap-sm">
            {
              categoriesWithPosts.map((category) => (
                <li class="list-none m-0">
                  <a
                    href={getCategoryUrl(category.slug)}
                    class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
                  >
                    {getCategoryDisplayName(category.slug, categoriesWithPosts)}
                  </a>
                </li>
              ))
            }
          </ul>
        </div>

        <div class="flex flex-col gap-md">
          <h4
            class="font-heading text-lg font-semibold text-heading m-0 leading-tight tracking-tight"
          >
            Resources
          </h4>
          <ul class="list-none p-0 m-0 flex flex-col gap-sm">
            <li class="list-none m-0">
              <a
                href="/rss.xml"
                class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
              >
                <Rss class="w-4 h-4 flex-shrink-0" />
                RSS Feed
              </a>
            </li>
            <li class="list-none m-0">
              <a
                href="/sitemap-index.xml"
                class="text-text-light no-underline text-sm transition-all duration-fast flex items-center gap-xs px-sm rounded-sm hover:text-link hover:translate-x-0.5 hover:bg-hover"
                >Sitemap</a
              >
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Footer bottom with legal and version info -->
    <div
      class="flex flex-col sm:flex-row sm:justify-between sm:items-center pt-8 border-t border-border-light gap-lg"
    >
      <div class="flex flex-col gap-sm">
        <p class="text-sm text-text-light m-0 font-serif italic">
          <sup>©</sup>
          {today.getFullYear()}
          {SITE_TITLE}. All rights reserved.
        </p>
        <div class="flex items-center gap-sm flex-wrap">
          <a
            href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-text-light no-underline text-sm transition-colors duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:bg-hover"
          >
            CC BY-NC-SA 4.0
            <ExternalLink class="w-[14px] h-[14px] opacity-70" />
          </a>
          <span class="text-text-lighter text-sm">•</span>
          <a
            href="https://opensource.org/licenses/MIT"
            target="_blank"
            rel="noopener noreferrer"
            class="text-text-light no-underline text-sm transition-colors duration-fast flex items-center gap-xs py-xs px-sm rounded-sm hover:text-link hover:bg-hover"
          >
            MIT License
            <ExternalLink class="w-[14px] h-[14px] opacity-70" />
          </a>
        </div>
      </div>

      <div class="flex flex-col items-start sm:items-end gap-xs">
        <span class="text-xs text-text-lighter font-mono">v0.0.1</span>
        <span class="text-xs text-text-lighter flex items-center gap-xs">
          Made with <Heart
            class="w-[14px] h-[14px] text-red-500 animate-pulse"
          /> using Astro
        </span>
      </div>
    </div>
  </div>
</footer>

<style>
  /* Dark theme adjustments */
  html[data-theme="dark"] .site-footer {
    background-color: #eeeeee;
    border-color: #9ca3af;
  }

  html[data-theme="dark"] .footer-bottom {
    border-color: #9ca3af;
  }
</style>
