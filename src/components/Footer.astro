---
import { Rss, FileText, Heart, ExternalLink } from "lucide-astro";
import { SITE_TITLE, SITE_DESCRIPTION } from "../consts";
import {
  getCategoriesWithPosts,
  getCategoryDisplayName,
  getCategoryUrl,
} from "../utils/categories";

const today = new Date();

// Get categories that have posts
const categoriesWithPosts = await getCategoriesWithPosts();
---

<footer
  class="bg-gray-50 dark:bg-gray-900 border-t border-gray-200 dark:border-gray-700 mt-16"
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
    <!-- Main footer content -->
    <div class="grid grid-cols-1 lg:grid-cols-[1fr_2fr] gap-12 lg:items-start">
      <!-- Site info -->
      <div class="space-y-6">
        <h3 class="text-3xl font-bold text-gray-900 dark:text-gray-100">
          {SITE_TITLE}
        </h3>
        <p
          class="text-gray-600 dark:text-gray-400 leading-relaxed max-w-md text-lg"
        >
          {SITE_DESCRIPTION}
        </p>
      </div>

      <!-- Navigation links -->
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-12">
        <!-- Navigation -->
        <div class="space-y-4">
          <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
            Navigation
          </h4>
          <ul class="space-y-3">
            <li>
              <a
                href="/"
                class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline"
              >
                Home
              </a>
            </li>
            <li>
              <a
                href="/writings"
                class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline"
              >
                Writings
              </a>
            </li>
            <li>
              <a
                href="/about"
                class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline"
              >
                About
              </a>
            </li>
          </ul>
        </div>

        <!-- Categories -->
        <div class="space-y-4">
          <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
            Categories
          </h4>
          <ul class="space-y-3">
            {
              categoriesWithPosts.map((category) => (
                <li>
                  <a
                    href={getCategoryUrl(category.slug)}
                    class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline"
                  >
                    {getCategoryDisplayName(category.slug, categoriesWithPosts)}
                  </a>
                </li>
              ))
            }
          </ul>
        </div>

        <!-- Resources -->
        <div class="space-y-4">
          <h4 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
            Resources
          </h4>
          <ul class="space-y-3">
            <li>
              <a
                href="/rss.xml"
                class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline flex items-center gap-2"
              >
                <Rss class="w-4 h-4" />
                RSS Feed
              </a>
            </li>
            <li>
              <a
                href="/sitemap-index.xml"
                class="text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-gray-100 transition-colors duration-200 text-base hover:underline"
              >
                Sitemap
              </a>
            </li>
          </ul>
        </div>
      </div>
    </div>

    <!-- Footer bottom -->
    <div
      class="border-t border-gray-200 dark:border-gray-700 pt-8 mt-12 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-6"
    >
      <!-- Copyright and licenses -->
      <div class="space-y-3">
        <p class="text-sm text-gray-500 dark:text-gray-400">
          © {today.getFullYear()}
          {SITE_TITLE}. All rights reserved.
        </p>
        <div class="flex items-center gap-4 flex-wrap">
          <a
            href="https://creativecommons.org/licenses/by-nc-sa/4.0/"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200 text-sm flex items-center gap-1 hover:underline"
          >
            CC BY-NC-SA 4.0
            <ExternalLink class="w-3 h-3 opacity-70" />
          </a>
          <span class="text-gray-400 dark:text-gray-500">•</span>
          <a
            href="https://opensource.org/licenses/MIT"
            target="_blank"
            rel="noopener noreferrer"
            class="text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-300 transition-colors duration-200 text-sm flex items-center gap-1 hover:underline"
          >
            MIT License
            <ExternalLink class="w-3 h-3 opacity-70" />
          </a>
        </div>
      </div>

      <!-- Version and tech info -->
      <div class="flex flex-col items-start sm:items-end gap-2">
        <span class="text-xs text-gray-400 dark:text-gray-500 font-mono"
          >v0.0.1</span
        >
        <span
          class="text-xs text-gray-400 dark:text-gray-500 flex items-center gap-1"
        >
          Made with <Heart class="w-3 h-3 text-red-500" /> using Astro
        </span>
      </div>
    </div>
  </div>
</footer>
